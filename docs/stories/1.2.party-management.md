# Story 1.2: Party Management

## Status

Draft

## Story

**As an** accountant,
**I want** to manage customer and supplier records,
**so that** I can track parties for trading and payments.

## Acceptance Criteria

1. Party schema with name, type (customer/supplier/both), gstin, state, address, phone, balance fields
2. GET `/parties` with type and isActive filters
3. POST `/parties` creates party with opening balance
4. GET `/parties/:id` returns party with current balance
5. PUT `/parties/:id` updates party details
6. DELETE `/parties/:id` soft-deletes party
7. State field used for GST type calculation (IGST vs CGST/SGST)
8. All endpoints protected and documented

## Tasks / Subtasks

- [ ] Create Party schema (AC: 1)
  - [ ] Create `modules/masters/party/party.schema.ts`
  - [ ] Add embedded address subdocument
  - [ ] Add currentBalance as denormalized field
- [ ] Create DTOs (AC: 3)
  - [ ] Create `create-party.dto.ts`
  - [ ] Create `update-party.dto.ts`
- [ ] Create Party service (AC: 2-6)
  - [ ] Implement CRUD operations
  - [ ] Implement filtering by type
- [ ] Create Party controller (AC: 2-6, 8)
  - [ ] Add CRUD endpoints
  - [ ] Add Swagger documentation
- [ ] Write unit tests

## Dev Notes

### Party Schema

```typescript
{
  name: string,
  type: 'customer' | 'supplier' | 'both',
  gstin: string,
  state: string,          // for GST calculation
  address: {
    line1: string,
    line2: string,
    city: string,
    pincode: string
  },
  phone: string,
  openingBalance: number,
  currentBalance: number, // denormalized
  isActive: boolean
}
```

### GST Logic (for later use in Trading)

- Same state: CGST + SGST
- Different state: IGST

## Testing

- Test CRUD operations
- Test type filtering (customer, supplier, both)

## Change Log

| Date       | Version | Description            | Author    |
| ---------- | ------- | ---------------------- | --------- |
| 2026-01-09 | 1.0     | Initial story creation | Architect |

## Dev Agent Record

### Agent Model Used

_To be filled by Dev Agent_

### Debug Log References

_To be filled by Dev Agent_

### Completion Notes List

_To be filled by Dev Agent_

### File List

_To be filled by Dev Agent_

## QA Results

_To be filled by QA Agent_
